Mapbox
====================

[Mapbox]@案例：https://github.com/lhywell/book/tree/master/map/example1

运行

```bash
$ cd example1
$ npm install
$ node map.js
```

浏览器中打开localhost:3000

## 简介
2010年成立，使用主要开源数据创建地图软件的公司，移动和web应用程序为主，目前每月超过3亿人在用。

官网：https://www.mapbox.com/

产品集中在：
1. 实时地图
2. 地图搜索
3. 地图导航
4. 自定义地图


## 矢量瓦片（Mapbox 2013.5提出的概念）

### 图层

在矢量瓦片中定义了图层的概念：矢量瓦片由一组命名的图层构成
1. 特点：栅格瓦片的1/4大小，节省带宽
2. 规范：https://www.mapbox.com/vector-tiles/specification/
3. 规范Git地址：https://github.com/mapbox/vector-tile-spec
5. 投影坐标系：Web墨卡托


### 兼容性
1. Mapbox的矢量瓦片地图，基于WEBGL标准

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0005.png)

数据由[CANIUSE](https://caniuse.com/#search=webgl)提供，可以看到IE11以下是不兼容的，大部分都是高版本浏览器

WebGL是一个3DCanvas绘图技术，是由多个浏览器厂商共同达成的一致标准，旨在通过硬件加速增强浏览器端3D渲染能力，他和W3C标准组织没有任何关系，目前流行的[three.js](https://threejs.org/)做了非常多的3D酷炫效果，是对webGl的整体封装


2. 支持旧版本Tilemill或者mapbox studio classic

## Mapbox Data Sources

### 数据来源：
1. Mapbox Streets - 包含来自世界各地的街道，建筑物和地点（ OSM ）
2. Mapbox Traffic - OSM
3. Mapbox Satellite -政府、机构
4. Mapbox Terrain – 政府、机构

### OpenStreetMap组织

OpenStreetMap是开源地图服务平台,是个公益性的组织，旨在创建用户自己的地图，大部分来自400万用户采集的gps数据、航拍图像的贡献，支持上传编辑，主要的客户有苹果、Foursquare，官网：http://www.openstreetmap.org

1. 文件格式：.osm
2. 坐标系：WGS84经纬度坐标

如果你对OpenStreetMap构建地图感兴趣，可以看下![learnosm](http://learnosm.org/zh_CN/)这个网站，你将学到如何创建OpenStreetMap账号、如何使用基本的地图编辑软件


## GeoJSON标准（2008年提出的）
在Mapbox中使用geojson数据，构建地图图层

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0007.png)

GeoJSON包含7种几何类型：Point（点）, LineString（线）, Polygon（多边形）, MultiPoint（多点）, MultiLineString（多线）, MultiPolygon（多个多边形）, and GeometryCollection（几何的集合）

如果你想生成一个GeoJSON文件，可以使用下边的转换工具：

1. [togeojson](https://www.npmjs.com/package/@mapbox/togeojson), a node package for converting KML and GPX (XML formats). 
2. [geojson.io](http://geojson.io) for creating, converting, and editing GeoJSON.

## Mapbox导航（2014.4）
https://www.mapbox.com/navigation/

功能：

1. 交通感知路由
2. 转弯提示
3. 错误路线指示
4. 步行，骑自行车和驾驶
5. 交通堵塞、事故

文档：

- Geocoding API
- Directions API
- Map matching API
- Optimization API
- Matrix API

## Mapbox地理编码（2015.6）

功能：

1. 自动补全
2. 高性能
3. 查询过滤数据
4. 存储查询结果
5. 企业客户支持批量查询
6. geocoding API支持python\javascript\React\Objective-c and Swift(IOS)\Android

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0006.png)

以上Mapbox在进行坐标转换地址，地址转换坐标，或者其他相关地理编码开发的时候，对于中国的地址支持的还不是很好。

## Mapbox Studio（2015.11）
在线编辑器，需要注册，然后创建地图，生成一个token，用于开发者使用，官网：https://www.mapbox.com/studio/

功能：
1. 3D渲染能力强
2. 支持移动平台canvas优势
3. 缩放级别22个级别
未来扩展到AR / VR，汽车和国际


![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0018.png)

## Mapbox车载导航（2016.6）

功能：

1. 支持地图定制
2. 支持自定义数据接入,比如充电站
3. 3D技术渲染，
4. 支持离线
5. iOS、Android、Qt、Linux平台

数据来源：从130万用户收集GPS数据，数据的准确性不足，相对便宜

在未来mapbox公司正在寻求与汽车行业合作将其地图整合到汽车信息娱乐系统和自动驾驶系统中

## Mapbox城市计划（2016.9）

官网：https://www.mapbox.com/cities/

案例：
https://urbica.co/citibike/

## 文档

### SDK DOCUMENTATION

- iOS SDK
- Android SDK
- Navigation SDK
- Unity SDK
- GL JS
- Qt SDK

### API DOCUMENTATION
- Directions API
- Geocoding API
- Uploads API
- Static API
- Matrix API
- Map Matching API
- Styles API
- Maps API
- Datasets API
- Optimization API

## Mapbox GL JS-前端

- API：https://www.mapbox.com/mapbox-gl-js/api/

- Example：https://www.mapbox.com/mapbox-gl-js/example/simple-map/

## Mapbox结合其他地图工具

- heatmap.js - https://www.patrick-wied.at/static/heatmapjs/
- Turf.js - http://turfjs.org/
- Tableau - https://www.tableau.com
- Leaflet - http://leafletjs.com
- Echarts - http://echarts.baidu.com/

## Mapbox客户群体

- 在Snapchat上与朋友分享，
- 在Weather.com上查看是否下雨，
- 在Bloomberg上追踪重大新闻，
- 或是在Lyft中查看您的ETA，
- Pinterest
- Foursquare
- MapQuest
- 让分析公司了解大地理数据
- 无人机公司发布天桥
- 房地产网站可视化房地产
- 卫星公司处理无云图像
- 保险公司跟踪资产。

## 案例


![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0008.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0009.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0010.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0011.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0012.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0013.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0014.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0015.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0016.png)

![map](https://raw.githubusercontent.com/lhywell/book/master/map/map0017.png)

## 总结

Mapbox具备4大能力：

1. 自定义地图能力
2. 结合GeoJson数据渲染能力
3. Mapbox GL，定位、搜索、导航
4. 结合其他地图工具能力


下一页：[Leaflet.js](https://github.com/lhywell/book/blob/master/map/2.2README.md)